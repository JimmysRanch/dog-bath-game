<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dog Bath Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      background-color: #fafafa;
    }
    h1 {
      margin-bottom: 10px;
    }
    #timer {
      font-size: 1.2rem;
      margin-bottom: 10px;
    }
    #progressBar {
      width: 100%;
      max-width: 400px;
      height: 20px;
      background-color: #eee;
      border-radius: 10px;
      overflow: hidden;
      margin-bottom: 15px;
    }
    #progress {
      height: 100%;
      width: 0%;
      background-color: #4caf50;
      transition: width 0.3s ease;
    }
    #gameContainer {
      position: relative;
      width: 100%;
      max-width: 400px;
      height: 300px;
      border: 2px solid #333;
      border-radius: 10px;
      background-color: #f5f5dc;
      overflow: hidden;
      touch-action: none;
    }
    .mud {
      position: absolute;
      border-radius: 50%;
      background-color: #8b4513;
    }
    #overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: none;
      align-items: center;
      justify-content: center;
      background-color: rgba(0, 0, 0, 0.5);
      color: #fff;
      font-size: 2rem;
      border-radius: 10px;
    }
    button#restart {
      margin-top: 15px;
      padding: 8px 16px;
      font-size: 1rem;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Dog Bath Game</h1>
  <div id="timer">Time: 30</div>
  <div id="progressBar"><div id="progress"></div></div>
  <div id="gameContainer">
    <div id="overlay"></div>
  </div>
  <button id="restart">Restart</button>
  <script>
    (function() {
      const totalTime = 30;
      let timeLeft = totalTime;
      let timerInterval;
      const timerEl = document.getElementById('timer');
      const progressEl = document.getElementById('progress');
      const gameContainer = document.getElementById('gameContainer');
      const overlay = document.getElementById('overlay');
      const restartBtn = document.getElementById('restart');
      let spots = [];
      let initialCount = 0;
      function createMudSpots(count) {
        const newSpots = [];
        for (let i = 0; i < count; i++) {
          const spot = document.createElement('div');
          spot.classList.add('mud');
          const size = 40 + Math.random() * 30;
          spot.style.width = size + 'px';
          spot.style.height = size + 'px';
          const maxX = gameContainer.clientWidth - size;
          const maxY = gameContainer.clientHeight - size;
          spot.style.left = Math.random() * maxX + 'px';
          spot.style.top = Math.random() * maxY + 'px';
          gameContainer.appendChild(spot);
          newSpots.push(spot);
        }
        return newSpots;
      }
      function startGame() {
        spots.forEach(s => s.remove());
        spots = createMudSpots(8);
        initialCount = spots.length;
        updateProgress();
        timeLeft = totalTime;
        timerEl.textContent = 'Time: ' + timeLeft;
        overlay.style.display = 'none';
        overlay.textContent = '';
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          timerEl.textContent = 'Time: ' + timeLeft;
          if (timeLeft <= 0) {
            endGame(false);
          }
        }, 1000);
      }
      function updateProgress() {
        const cleaned = initialCount - spots.length;
        const percent = (cleaned / initialCount) * 100;
        progressEl.style.width = percent + '%';
      }
      function endGame(win) {
        clearInterval(timerInterval);
        overlay.style.display = 'flex';
        overlay.textContent = win ? 'You Win!' : "Time's Up!";
      }
      function removeSpot(spot) {
        const idx = spots.indexOf(spot);
        if (idx >= 0) {
          spot.remove();
          spots.splice(idx, 1);
          updateProgress();
          if (spots.length === 0) {
            endGame(true);
          }
        }
      }
      function cleanAt(x, y) {
        const rect = gameContainer.getBoundingClientRect();
        const relX = x - rect.left;
        const relY = y - rect.top;
        spots.slice().forEach(spot => {
          const sX = parseFloat(spot.style.left);
          const sY = parseFloat(spot.style.top);
          const sW = spot.offsetWidth;
          const sH = spot.offsetHeight;
          if (relX >= sX && relX <= sX + sW && relY >= sY && relY <= sY + sH) {
            removeSpot(spot);
          }
        });
      }
      let mouseDown = false;
      gameContainer.addEventListener('mousedown', (e) => {
        mouseDown = true;
        cleanAt(e.clientX, e.clientY);
      });
      document.addEventListener('mousemove', (e) => {
        if (mouseDown) {
          cleanAt(e.clientX, e.clientY);
        }
      });
      document.addEventListener('mouseup', () => {
        mouseDown = false;
      });
      gameContainer.addEventListener('touchstart', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        cleanAt(touch.clientX, touch.clientY);
      }, {passive: false});
      gameContainer.addEventListener('touchmove', (e) => {
        e.preventDefault();
        const touch = e.touches[0];
        cleanAt(touch.clientX, touch.clientY);
      }, {passive: false});
      restartBtn.addEventListener('click', () => {
        startGame();
      });
      startGame();
    })();
  </script>
</body>
</html>
